<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8"/>
    <title>RDAP Lookup</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="./assets/bootstrap.min.css" />
    <link rel="shortcut icon" href="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPjxzdmcgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczpzb2RpcG9kaT0iaHR0cDovL3NvZGlwb2RpLnNvdXJjZWZvcmdlLm5ldC9EVEQvc29kaXBvZGktMC5kdGQiIHhtbG5zOmNjPSJodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9ucyMiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOm5zMT0iaHR0cDovL3NvemkuYmFpZXJvdWdlLmZyIiBpZD0ic3ZnNTM3OCIgc29kaXBvZGk6ZG9jbmFtZT0iRG9jdW1lbnRvIG51ZXZvIDE4IiB2aWV3Qm94PSIwIDAgMTg2LjY5IDIwNi4wNyIgdmVyc2lvbj0iMS4xIiBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ3cHJlNCByMjI0NDYiPjxkZWZzIGlkPSJkZWZzMyI+PGxpbmVhckdyYWRpZW50IGlkPSJsaW5lYXJHcmFkaWVudDYwMzUiPjxzdG9wIGlkPSJzdG9wNjAzNyIgc3R5bGU9InN0b3AtY29sb3I6I2ZmZmZmZiIgb2Zmc2V0PSIwIi8+PHN0b3AgaWQ9InN0b3A2MDM5IiBzdHlsZT0ic3RvcC1jb2xvcjojZmZmZmZmO3N0b3Atb3BhY2l0eTowIiBvZmZzZXQ9IjEiLz48L2xpbmVhckdyYWRpZW50PjxmaWx0ZXIgaWQ9ImZpbHRlcjYwOTMiIGhlaWdodD0iMS4zODU1IiB3aWR0aD0iMS4xMjg1IiBjb2xvci1pbnRlcnBvbGF0aW9uLWZpbHRlcnM9InNSR0IiIHk9Ii0uMTkyNzciIHg9Ii0uMDY0MjU3IiBpbmtzY2FwZTpjb2xsZWN0PSJhbHdheXMiPjxmZUdhdXNzaWFuQmx1ciBpZD0iZmVHYXVzc2lhbkJsdXI2MDk1IiBzdGREZXZpYXRpb249IjAuODkyNTA0MjUiIGlua3NjYXBlOmNvbGxlY3Q9ImFsd2F5cyIvPjwvZmlsdGVyPjxsaW5lYXJHcmFkaWVudCBpZD0ibGluZWFyR3JhZGllbnQ2MTEwIiB5Mj0iNTExLjk3IiBzcHJlYWRNZXRob2Q9InJlZmxlY3QiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiB4Mj0iMjg2LjYzIiBncmFkaWVudFRyYW5zZm9ybT0ibWF0cml4KDEuMTgxOCAwIDAgMS4xODE4IC0zMC42NDkgLTY5LjM5NCkiIHkxPSI1MTEuOTciIHgxPSIyNjkuOTciIGlua3NjYXBlOmNvbGxlY3Q9ImFsd2F5cyI+PHN0b3AgaWQ9InN0b3A1NDk3IiBzdHlsZT0ic3RvcC1jb2xvcjojYzZjNmM2IiBvZmZzZXQ9IjAiLz48c3RvcCBpZD0ic3RvcDU1MDEiIHN0eWxlPSJzdG9wLWNvbG9yOiNlM2UzZTMiIG9mZnNldD0iLjIwNDg1Ii8+PHN0b3AgaWQ9InN0b3A1NDk5IiBzdHlsZT0ic3RvcC1jb2xvcjojYTVhNWE4IiBvZmZzZXQ9IjEiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCBpZD0ibGluZWFyR3JhZGllbnQ2MTEyIiB5Mj0iNTI3LjM0IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDI9IjI4Ni42MyIgeTE9IjUxOC41NiIgeDE9IjI4Mi4zNiIgaW5rc2NhcGU6Y29sbGVjdD0iYWx3YXlzIj48c3RvcCBpZD0ic3RvcDU0NjgiIHN0eWxlPSJzdG9wLWNvbG9yOiNlM2UzZTMiIG9mZnNldD0iMCIvPjxzdG9wIGlkPSJzdG9wNTQ3MCIgc3R5bGU9InN0b3AtY29sb3I6I2E1YTVhOCIgb2Zmc2V0PSIxIi8+PC9saW5lYXJHcmFkaWVudD48bGluZWFyR3JhZGllbnQgaWQ9ImxpbmVhckdyYWRpZW50NjExNCIgeTI9IjUyMC4zMyIgeGxpbms6aHJlZj0iI2xpbmVhckdyYWRpZW50NjAzNSIgc3ByZWFkTWV0aG9kPSJyZWZsZWN0IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDI9IjMyNy43OCIgZ3JhZGllbnRUcmFuc2Zvcm09InRyYW5zbGF0ZSgwIC4yNSkiIHkxPSI1MjIuNjEiIHgxPSIzMDguNSIgaW5rc2NhcGU6Y29sbGVjdD0iYWx3YXlzIi8+PGxpbmVhckdyYWRpZW50IGlkPSJsaW5lYXJHcmFkaWVudDYxMTYiIHkyPSI1MjAuMzMiIHhsaW5rOmhyZWY9IiNsaW5lYXJHcmFkaWVudDYwMzUiIHNwcmVhZE1ldGhvZD0icmVmbGVjdCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIHgyPSIzMjcuNzgiIGdyYWRpZW50VHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwxMikiIHkxPSI1MjIuNjEiIHgxPSIzMDguNSIgaW5rc2NhcGU6Y29sbGVjdD0iYWx3YXlzIi8+PGxpbmVhckdyYWRpZW50IGlkPSJsaW5lYXJHcmFkaWVudDYxMTgiIHkyPSI1MjAuMzMiIHhsaW5rOmhyZWY9IiNsaW5lYXJHcmFkaWVudDYwMzUiIHNwcmVhZE1ldGhvZD0icmVmbGVjdCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIHgyPSIzMjcuNzgiIGdyYWRpZW50VHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCwyMikiIHkxPSI1MjIuNjEiIHgxPSIzMDguNSIgaW5rc2NhcGU6Y29sbGVjdD0iYWx3YXlzIi8+PC9kZWZzPjxzb2RpcG9kaTpuYW1lZHZpZXcgaWQ9ImJhc2UiIGJvcmRlcmNvbG9yPSIjNjY2NjY2IiBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIiBpbmtzY2FwZTp3aW5kb3cteT0iMjQiIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iOTQ5IiBpbmtzY2FwZTp3aW5kb3ctbWF4aW1pemVkPSIxIiBpbmtzY2FwZTp6b29tPSIxIiBpbmtzY2FwZTp3aW5kb3cteD0iMCIgc2hvd2dyaWQ9ImZhbHNlIiBib3JkZXJvcGFjaXR5PSIxLjAiIGlua3NjYXBlOmN1cnJlbnQtbGF5ZXI9ImxheWVyMSIgaW5rc2NhcGU6Y3g9IjIxLjQ4ODE5MSIgaW5rc2NhcGU6Y3k9IjE4OS40OTExMiIgaW5rc2NhcGU6d2luZG93LXdpZHRoPSIxMjgwIiBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIiBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0ibW0iLz48ZyBpZD0ibGF5ZXIxIiBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTI4NS44NyAtNTEwLjY5KSI+PGcgaWQ9Imc2MDk3IiB0cmFuc2Zvcm09Im1hdHJpeCg0LjE5OTIgMCAwIDQuMTk5MiAtOTE0LjU2IC0xNjMzLjgpIj48cGF0aCBpZD0icGF0aDYwNzkiIHNvZGlwb2RpOnJ4PSIxNi42Njc1MTciIHNvZGlwb2RpOnJ5PSI1LjU1NTgzOTEiIHN0eWxlPSJmaWx0ZXI6dXJsKCNmaWx0ZXI2MDkzKTtmaWxsOiMyZTM0MzYiIHNvZGlwb2RpOnR5cGU9ImFyYyIgZD0ibTMwMy4zIDUyMS43OGMwIDMuMDY4NC03LjQ2MjMgNS41NTU4LTE2LjY2OCA1LjU1NTgtOS4yMDUyIDAtMTYuNjY4LTIuNDg3NC0xNi42NjgtNS41NTU4czcuNDYyMy01LjU1NTggMTYuNjY4LTUuNTU1OGM5LjIwNTIgMCAxNi42NjggMi40ODc0IDE2LjY2OCA1LjU1NTh6IiB0cmFuc2Zvcm09Im1hdHJpeCgxLjE4MTggMCAwIDEuMTgxOCAtMzAuNjQ5IC02NS45ODQpIiBzb2RpcG9kaTpjeT0iNTIxLjc3OTU0IiBzb2RpcG9kaTpjeD0iMjg2LjYzMDgiLz48cGF0aCBpZD0icGF0aDU0ODgiIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2Njc3NzY2NjYyIgc3R5bGU9ImZpbGw6dXJsKCNsaW5lYXJHcmFkaWVudDYxMTApIiBkPSJtMjg4LjQxIDUxNy41djMwLjA5MmgwLjEyNWMtMC4wODA2IDAuMjQxMjYtMC4xMjUgMC40NzAzMi0wLjEyNSAwLjcxODc1IDAgMy42MjYzIDguODA4NiA2LjU2MjUgMTkuNjg4IDYuNTYyNXMxOS42ODgtMi45MzYyIDE5LjY4OC02LjU2MjVjMC0wLjI0ODc5LTAuMDQ0Mi0wLjQ3NzE1LTAuMTI1LTAuNzE4NzVoMC4xMjV2LTMwLjA5MmgtMzkuMzc1eiIvPjxwYXRoIGlkPSJwYXRoNTQ2MCIgc29kaXBvZGk6cng9IjE2LjY2NzUxNyIgc29kaXBvZGk6cnk9IjUuNTU1ODM5MSIgc3R5bGU9ImZpbGw6dXJsKCNsaW5lYXJHcmFkaWVudDYxMTIpIiBzb2RpcG9kaTp0eXBlPSJhcmMiIGQ9Im0zMDMuMyA1MjEuNzhjMCAzLjA2ODQtNy40NjIzIDUuNTU1OC0xNi42NjggNS41NTU4LTkuMjA1MiAwLTE2LjY2OC0yLjQ4NzQtMTYuNjY4LTUuNTU1OHM3LjQ2MjMtNS41NTU4IDE2LjY2OC01LjU1NThjOS4yMDUyIDAgMTYuNjY4IDIuNDg3NCAxNi42NjggNS41NTU4eiIgdHJhbnNmb3JtPSJtYXRyaXgoMS4xODE4IDAgMCAxLjE4MTggLTMwLjY0OSAtOTkuMzk0KSIgc29kaXBvZGk6Y3k9IjUyMS43Nzk1NCIgc29kaXBvZGk6Y3g9IjI4Ni42MzA4Ii8+PHBhdGggaWQ9InBhdGg2MDI2IiBzdHlsZT0iZmlsbDojNTY1NjU2IiBkPSJtMjg4LjM4IDUzOS4wOWMwLjE0NzM1IDMuNTg0IDguOTMxOCA2LjQ2ODggMTkuNzE5IDYuNDY4OCAxMC43NTYgMCAxOS40OTItMi44Njc3IDE5LjY4OC02LjQzNzUtMy40NTE1IDIuOTM1OS0xMC45NTkgNC45Njg4LTE5LjY4OCA0Ljk2ODgtOC43NDYxIDAtMTYuMjc3LTIuMDU0NC0xOS43MTktNXoiLz48cGF0aCBpZD0icGF0aDYwMzAiIHN0eWxlPSJmaWxsOnVybCgjbGluZWFyR3JhZGllbnQ2MTE0KSIgZD0ibTI4OC4zOCA1MTcuMzRjMC4xNDczNSAzLjU4NCA4LjkzMTggNi40Njg4IDE5LjcxOSA2LjQ2ODggMTAuNzU2IDAgMTkuNDkyLTIuODY3NyAxOS42ODgtNi40Mzc1LTAuMjE1NzIgMC4xODM0OS0wLjQ0MDc4IDAuMzU1MDktMC42ODc1IDAuNTMxMjUtMC4wMDkgMC4wMTE3LTAuMDIxNiAwLjAxOTYtMC4wMzEyIDAuMDMxMi0yLjI5MjEgMi43Nzc0LTkuOTAzNSA0LjgxMjUtMTguOTY5IDQuODEyNS05LjEyMiAwLTE2Ljc4Ni0yLjA3MDctMTkuMDMxLTQuODc1LTAuMDI0OS0wLjAxNzktMC4wMzgtMC4wNDQ2LTAuMDYyNS0wLjA2MjUtMC4yMTg3Mi0wLjE1OTY5LTAuNDMxNTktMC4zMDMyMy0wLjYyNS0wLjQ2ODc1eiIvPjxnIGlkPSJnNjA3MSI+PGcgaWQ9Imc2MDY3IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0uNTIzMTUpIj48cGF0aCBpZD0icGF0aDYwMjIiIHN0eWxlPSJmaWxsOiM1NjU2NTYiIGQ9Im0yODguMzggNTI5LjA5YzAuMTQ3MzUgMy41ODQgOC45MzE4IDYuNDY4OCAxOS43MTkgNi40Njg4IDEwLjc1NiAwIDE5LjQ5Mi0yLjg2NzcgMTkuNjg4LTYuNDM3NS0zLjQ1MTUgMi45MzU5LTEwLjk1OSA0Ljk2ODgtMTkuNjg4IDQuOTY4OC04Ljc0NjEgMC0xNi4yNzctMi4wNTQ0LTE5LjcxOS01eiIvPjxwYXRoIGlkPSJwYXRoNjA0MyIgc3R5bGU9ImZpbGw6dXJsKCNsaW5lYXJHcmFkaWVudDYxMTYpIiBkPSJtMjg4LjM4IDUyOS4wOWMwLjE0NzM1IDMuNTg0IDguOTMxOCA2LjQ2ODggMTkuNzE5IDYuNDY4OCAxMC43NTYgMCAxOS40OTItMi44Njc3IDE5LjY4OC02LjQzNzUtMC4wNDk3IDAuMDQyMi0wLjEwNTQzIDAuMDgzOC0wLjE1NjI1IDAuMTI1LTEuMjQyMiAzLjIyNjgtOS41MTA2IDUuNzE4OC0xOS41MzEgNS43MTg4LTEwLjExMyAwLTE4LjQ2OC0yLjUxMTItMTkuNTk0LTUuNzgxMi0wLjA0MDEtMC4wMzE3LTAuMDg2My0wLjA2MDctMC4xMjUtMC4wOTM3eiIvPjwvZz48cGF0aCBpZD0icGF0aDYwNTQiIHN0eWxlPSJmaWxsOnVybCgjbGluZWFyR3JhZGllbnQ2MTE4KSIgZD0ibTI4OC4zOCA1MzkuMDljMC4xNDczNSAzLjU4NCA4LjkzMTggNi40Njg4IDE5LjcxOSA2LjQ2ODggMTAuNzU2IDAgMTkuNDkyLTIuODY3NyAxOS42ODgtNi40Mzc1LTAuMDQ5NyAwLjA0MjItMC4xMDU0MyAwLjA4MzgtMC4xNTYyNSAwLjEyNS0xLjI0MjIgMy4yMjY4LTkuNTEwNiA1LjcxODgtMTkuNTMxIDUuNzE4OC0xMC4xMTMgMC0xOC40NjgtMi41MTEyLTE5LjU5NC01Ljc4MTItMC4wNDAxLTAuMDMxNy0wLjA4NjMtMC4wNjA3LTAuMTI1LTAuMDkzN3oiLz48L2c+PHBhdGggaWQ9InBhdGg2MDYwIiBzdHlsZT0iZmlsbDojNTY1NjU2IiBkPSJtMjg4LjUgNTQ5Ljk0YzEuMTI2IDMuMjcgOS40ODEgNS43ODEyIDE5LjU5NCA1Ljc4MTIgMTAuMDIxIDAgMTguMjg5LTIuNDkyIDE5LjUzMS01LjcxODgtMy41MTYzIDIuODY3OC0xMC45MjkgNC44NDM4LTE5LjUzMSA0Ljg0MzgtOC42NDc4IDAtMTYuMS0yLjAxMzctMTkuNTk0LTQuOTA2MnoiLz48L2c+PC9nPjxtZXRhZGF0YT48cmRmOlJERj48Y2M6V29yaz48ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD48ZGM6dHlwZSByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIi8+PGNjOmxpY2Vuc2UgcmRmOnJlc291cmNlPSJodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9wdWJsaWNkb21haW4vIi8+PGRjOnB1Ymxpc2hlcj48Y2M6QWdlbnQgcmRmOmFib3V0PSJodHRwOi8vb3BlbmNsaXBhcnQub3JnLyI+PGRjOnRpdGxlPk9wZW5jbGlwYXJ0PC9kYzp0aXRsZT48L2NjOkFnZW50PjwvZGM6cHVibGlzaGVyPjxkYzp0aXRsZT5kYXRhYmFzZSBzeW1ib2w8L2RjOnRpdGxlPjxkYzpkYXRlPjIwMTAtMTEtMDhUMjI6MDg6NDM8L2RjOmRhdGU+PGRjOmRlc2NyaXB0aW9uPmRhdGFiYXNlIHN5bWJvbCBpbiBtZXRhbGxpYyBzdHlsZTwvZGM6ZGVzY3JpcHRpb24+PGRjOnNvdXJjZT5odHRwczovL29wZW5jbGlwYXJ0Lm9yZy9kZXRhaWwvOTQ3MjMvZGF0YWJhc2Utc3ltYm9sLWJ5LXJnMTAyNDwvZGM6c291cmNlPjxkYzpjcmVhdG9yPjxjYzpBZ2VudD48ZGM6dGl0bGU+cmcxMDI0PC9kYzp0aXRsZT48L2NjOkFnZW50PjwvZGM6Y3JlYXRvcj48ZGM6c3ViamVjdD48cmRmOkJhZz48cmRmOmxpPmRhdGFiYXNlPC9yZGY6bGk+PHJkZjpsaT5zZXJ2ZXI8L3JkZjpsaT48cmRmOmxpPnN5bWJvbDwvcmRmOmxpPjwvcmRmOkJhZz48L2RjOnN1YmplY3Q+PC9jYzpXb3JrPjxjYzpMaWNlbnNlIHJkZjphYm91dD0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbGljZW5zZXMvcHVibGljZG9tYWluLyI+PGNjOnBlcm1pdHMgcmRmOnJlc291cmNlPSJodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9ucyNSZXByb2R1Y3Rpb24iLz48Y2M6cGVybWl0cyByZGY6cmVzb3VyY2U9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zI0Rpc3RyaWJ1dGlvbiIvPjxjYzpwZXJtaXRzIHJkZjpyZXNvdXJjZT0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjRGVyaXZhdGl2ZVdvcmtzIi8+PC9jYzpMaWNlbnNlPjwvcmRmOlJERj48L21ldGFkYXRhPjwvc3ZnPg==" />
    <style>
      dd {
        margin: 0.5em 0 1em 2em;
      }
      .card {
        margin-bottom:1em;
      }
      dl {
        margin:0;
      }
    </style>
    <script>
      // keeps track of the elements we've created so we can assign a unique ID
      var elementCounter = 123456;

      var cardTitles = {
        "domain": "Domain Name",
        "ip network": "IP Network",
        "nameserver": "Nameserver",
        "entity": "Entity",
        "autnum": "AS Number",
      };

      // event handler for when the query type changes
      function updatePlaceHolder(type) {
        var input = document.getElementById('object');

        switch (type) {
          case 'ip':
            input.placeholder = '192.168.0.1/16';
            break;

          case 'autnum':
            input.placeholder = '65535';
            break;

          case 'entity':
            input.placeholder = 'ABC123-EXAMPLE';
            break;

          case 'url':
            input.placeholder = 'https://rdap.org/domain/example.com';
            break;

          case 'tld':
            input.placeholder = 'example';
            break;

          case 'registrar':
            input.placeholder = '9999';
            break;

          case 'json':
            input.placeholder = '{ (paste JSON) }';
            break;

          default:    
            input.placeholder = 'example.com';
        }
      }

      // event handler for when the submit button is pressed, or
      // when the user clicks on a link to an RDAP URL
      function doQuery() {
        var type = document.getElementById('type');
        var typeval = type.options[type.selectedIndex].value;
        var object = document.getElementById('object').value;

        var url;
        if ('url' == typeval) {
          url = object;

        } else if ('tld' == typeval) {
          url = 'https://root.rdap.org/domain/' + object;

        } else if ('registrar' == typeval) {
          url = 'https://registrars.rdap.org/entity/' + object + '-IANA';

        } else if ('json' == typeval) {
          url = 'json://' + object;

        } else {
          url = getRDAPURL(typeval, object);

        }

        sendQuery(url);
      }

      // construct an RDAP URL for the given object
      function getRDAPURL(typeval, object) {
        return 'https://rdap.org/' + typeval + '/' + object;
      }

      // given a URL, injects that URL into the query input,
      // and initiates an RDAP query
      function runQuery(url) {
        var type = document.getElementById('type');

        for (var i = 0 ; i < type.options.length ; i++) if ('url' == type.options[i].value) type.selectedIndex = i;
        document.getElementById('object').value = url;
        doQuery();
      }

      // disable the user interface, initiate an XHR
      function sendQuery(url) {
        document.getElementById('type').disabled = true;
        document.getElementById('object').disabled = true;
        document.getElementById('button').disabled = true;

        var div = document.getElementById('output-div');
        div.innerHTML = '';
    
          var spinner = document.createElement('div');
          spinner.classList.add('spinner-border');
          spinner.role = 'status';
          var span = spinner.appendChild(document.createElement('span'));
          span.classList.add('sr-only');
          span.appendChild(document.createTextNode('Loading...'));
          div.appendChild(spinner);

        if (0 == url.indexOf('json://')) {
          // run the callback with a mock XHR
          handleResponse({
            "status": 200,
            "response": JSON.parse(url.substring(7))
          });

        } else {
          var xhr = new XMLHttpRequest();
          xhr.open('GET', url);
          xhr.timeout = 25000;
          xhr.responseType = 'json';

          xhr.ontimeout = function() {
            document.getElementById('type').disabled = false;
            document.getElementById('object').disabled = false;
            document.getElementById('button').disabled = false;

            handleError('Timeout performing query, please try again later.');
          };

          xhr.onload = function() { handleResponse(xhr); };

          xhr.send();
        }
      }

      function handleError(error) {
        var div = document.getElementById('output-div');
        div.innerHTML = '';
        div.appendChild(createErrorNode(error));
      }

      function createErrorNode(error) {
        el = document.createElement('p');
        el.classList.add('error', 'alert', 'alert-warning');
        el.appendChild(document.createTextNode(error));

        return el;
      }

      // callback executed when a response is received
      function handleResponse(xhr) {
        document.getElementById('type').disabled = false;
        document.getElementById('object').disabled = false;
        document.getElementById('button').disabled = false;

        if (200 != xhr.status) {
          handleError(xhr.status + ' error: ' + xhr.statusText);

        } else {
          try {
                  var div = document.getElementById('output-div');
                  div.innerHTML = '';
                  div.appendChild(processObject(xhr.response, true));

                  var url = document.createElement('a');
                  url.href = window.location.href;
                  url.search = '?type=' + escape(document.getElementById('type').value) + '&object=' + escape(document.getElementById('object').value);

                  window.history.pushState(null, window.title, url.href);

          } catch (e) {
            handleError('Exception: ' + e.message);

          }
        }

      }

      // process an RDAP object. Argument is a JSON object, return
      // value is an element that can be inserted into the page
      function processObject(object, toplevel) {
        if (!object) return false;

        var dl = document.createElement('dl');

        switch (object.objectClassName) {
          case 'domain':
            processDomain(object, dl, toplevel);
            break;

          case 'nameserver':
            processNameserver(object, dl, toplevel);
            break;

          case 'entity':
            processEntity(object, dl, toplevel);
            break;

          case 'autnum':
            processAutnum(object, dl, toplevel);
            break;

          case 'ip network':
            processIp(object, dl, toplevel);
            break;

          default:
            if (object.errorCode) {
              return createErrorNode(object.errorCode + ' error: ' + object.title);

            } else {
              return createErrorNode("unknown object type '" + object.objectClassName + "'");

            }
        }

        var card = document.createElement('div');
        card.classList.add('card');

        var titleText = '';
        if (object.unicodeName) {
          titleText = object.unicodeName.toUpperCase();

        } else if (object.ldhName) {
          titleText = object.ldhName.toUpperCase();

        } else if (object.handle) {
          titleText = object.handle.toUpperCase();

        }

        if (object.handle && object.handle != titleText) titleText += ' (' + object.handle + ')';

        titleText = cardTitles[object.objectClassName] + ' ' + titleText;

        var title = document.createElement('div');
        title.classList.add('card-header', 'font-weight-bold');
        title.appendChild(document.createTextNode(titleText));
        card.appendChild(title);

        var body = document.createElement('div');
        body.classList.add('card-body');

        body.appendChild(dl);

        card.appendChild(body);
        return card;
      }

      // simplify the process of adding a name => value to a definition list
      function addProperty(dl, name, value) {

        var dt = document.createElement('dt');
        dt.classList.add('rdap-property-name');
        dt.appendChild(document.createTextNode(name));
        dl.appendChild(dt);

        var dd = document.createElement('dd');
        dd.classList.add('rdap-property-value');
        if (value instanceof Node) {
          dd.appendChild(value);

        } else {
          dd.appendChild(document.createTextNode(String(value)));

        }
        dl.appendChild(dd);
      }

      // called by the individual object processors, since all RDAP objects have a similar set of
      // properties. the first argument is the RDAP object and the second is the <dl> element
      // being used to display that object.
      function processCommonObjectProperties(object, dl) {
        // if (object.objectClassName) addProperty(dl, 'Object Type:', object.objectClassName);
        // if (object.handle) addProperty(dl, 'Handle:', object.handle);
        if (object.status) processStatus(object.status, dl);
        if (object.events) processEvents(object.events, dl);
        if (object.entities) processEntities(object.entities, dl);
        if (object.remarks) processRemarks(object.remarks, dl);
        if (object.notices) processNotices(object.notices, dl);
        if (object.links) processLinks(object.links, dl);
        if (object.lang) addProperty(dl, 'Language:', object.lang);
        if (object.port43) addProperty(dl, 'Whois Server:', object.port43);
        if (object.rdapConformance) processrdapConformance(object.rdapConformance, dl);

        var div = document.createElement('div');
        div.id = 'element-' + ++elementCounter;

        var button = document.createElement('button');
        button.classList.add('btn', 'btn-secondary');
        button.appendChild(document.createTextNode('Show'));
        button.onclick = new Function('showRawData("' + div.id + '");return false');
        div.appendChild(button);

        var pre = document.createElement('pre');
        pre.style = 'display:none;visibility:hidden';
        pre.appendChild(document.createTextNode(JSON.stringify(object, null, 2)));
        div.appendChild(pre);

        addProperty(dl, 'Raw Data:', div);
      }

      // call back for "Show Raw Data" button
      function showRawData(id) {
        var div = document.getElementById(id);
        div.childNodes[0].style = 'display:none;visibility:hidden';
        div.childNodes[1].style = 'display:block;visibility:visible';
      }

      // convert an array into a bulleted list
      function createList(list) {
        var ul = document.createElement('ul');

        for (var i = 0 ; i < list.length ; i++) {
          var li = document.createElement('li');
          if (list[i] instanceof Node) {
            li.appendChild(list[i]);

          } else {
            li.appendChild(document.createTextNode(list[i]));

          }
          ul.appendChild(li);
        }

        return ul;
      }

      // add the RDAP conformance of the response
      function processrdapConformance(rdapConformance, dl) {
        addProperty(dl, 'Conformance:', createList(rdapConformance));
      }

      // add the object's status codes
      function processStatus(status, dl) {
        addProperty(dl, 'Status:', createList(status));
      }

      // add the object's events
      function processEvents(events, dl) {
        var sdl = document.createElement('dl');

        for (var i = 0 ; i < events.length ; i++) {
          var span1 = document.createElement('span');
          span1.appendChild(document.createTextNode(new Date(events[i].eventDate).toLocaleString()));
          span1.classList.add('rdap-event-time');
          span1.setAttribute('title', events[i].eventDate);

          var span2 = document.createElement('span');
          span2.appendChild(span1);

          if (events[i].eventActor) {
                var em = document.createElement('em');
                em.appendChild(document.createElement(' by ' + events[i].eventActor));
                span2.appendChild(em);
          }
          addProperty(sdl, events[i].eventAction + ':', span2);
        }

        addProperty(dl, 'Events:', sdl);
      }

      // add the object's links
      function processLinks(links, dl) {
        var ul = document.createElement('ul');

        for (var i = 0 ; i < links.length ; i++) {
          li = document.createElement('li');

          var title = (links[i].title ? links[i].title : links[i].href);

          var link;
          if (links[i].type && 0 == links[i].type.indexOf('application/rdap+json')) {
            link = createRDAPLink(links[i].href, title);

          } else {
            link = document.createElement('a');
            link.rel = 'noopener';
            link.title = link.href = links[i].href;
            link.target = '_new';
            link.appendChild(document.createTextNode(title));

          }

          li.appendChild(link);

          if (links[i].rel) li.appendChild(document.createTextNode(' (' + links[i].rel + ')'));

          ul.appendChild(li);
        }

        addProperty(dl, 'Links:', ul);
      }

      // add the object's entities
      function processEntities(entities, dl) {
        var div = document.createElement('div');

        for (var i = 0 ; i < entities.length ; i++) div.appendChild(processObject(entities[i]));

        addProperty(dl, 'Entities:', div);
      }

      // add the object's remarks
      function processRemarks(remarks, dl) {
        addProperty(dl, 'Remarks:', processRemarksOrNotices(remarks));

      }

      // add the responses's notices
      function processNotices(notices, dl) {
        addProperty(dl, 'Notices:', processRemarksOrNotices(notices));
      }

      // command handler for remarks and notices
      function processRemarksOrNotices(things) {
        var div = document.createElement('div');

        for (var i = 0 ; i < things.length ; i++) {
          var section = document.createElement('section');
          section.classList.add('card');
          div.appendChild(section);

          var title = document.createElement('header');
          title.classList.add('card-header', 'font-weight-bold');
          title.appendChild(document.createTextNode(things[i].title));
          section.appendChild(title);

          var body = document.createElement('div');
          body.classList.add('card-body');
          section.appendChild(body);

          if (things[i].description) for (var j = 0 ; j < things[i].description.length ; j++) {
            var p = document.createElement('p');
            p.appendChild(document.createTextNode(things[i].description[j]));
            body.appendChild(p);
          }

          if (things[i].links) {
            var ldl = document.createElement('dl');
            processLinks(things[i].links, ldl);
            body.appendChild(ldl);
          }
        }

        return div;
      }

      // process a domain
      function processDomain(object, dl, toplevel=false) {

        if (toplevel) document.title = 'Domain ' + (object.unicodeName ? object.unicodeName : object.ldhName).toUpperCase() + ' - RDAP Lookup';

        if (object.unicodeName) {
          addProperty(dl, 'Name:', object.unicodeName);
          addProperty(dl, 'ASCII Name:', object.ldhName);

        } else {
          addProperty(dl, 'Name:', object.ldhName);

        }

        if (object.handle) addProperty(dl, 'Handle:', object.handle);

        // process events, status and entities here, then set them to null so processCommonObjectProperties()
        // doesn't process them again. this makes the output look more like a traditional whois record:
        if (object.events) processEvents(object.events, dl);
        if (object.status) processStatus(object.status, dl);
        if (object.entities) processEntities(object.entities, dl);

        object.events = object.status = object.entities = null;

        if (object.nameservers) {
          var div = document.createElement('div');

          for (var i = 0 ; i < object.nameservers.length ; i++) div.appendChild(processObject(object.nameservers[i]));

          addProperty(dl, 'Nameservers:', div);
        }

        addProperty(dl, 'DNSSEC:', object.secureDNS && object.secureDNS.delegationSigned ? 'Secure' : 'Insecure');

        processCommonObjectProperties(object, dl);
      }

      // process a nameserver
      function processNameserver(object, dl, toplevel=false) {

        if (toplevel) document.title = 'Nameserver ' + object.ldhName + ' - RDAP Lookup';

        addProperty(dl, 'Host Name:', object.ldhName);
        if (object.unicodeName) addProperty(dl, 'Internationalised Domain Name:', object.unicodeName);
        if (object.handle) addProperty(dl, 'Handle:', object.handle);

        if (object.ipAddresses) {
          if (object.ipAddresses.v4) {
            for (var i = 0 ; i < object.ipAddresses.v4.length ; i++) {
              addProperty(dl, 'IP Address:', createRDAPLink('https://rdap.org/ip/' + object.ipAddresses.v4[i], object.ipAddresses.v4[i]));
            }
          }

          if (object.ipAddresses.v6) {
            for (var i = 0 ; i < object.ipAddresses.v6.length ; i++) {
              addProperty(dl, 'IP Address:', createRDAPLink('https://rdap.org/ip/' + object.ipAddresses.v6[i], object.ipAddresses.v6[i]));
            }
          }
        }

        processCommonObjectProperties(object, dl);
      }

      // process an entity
      function processEntity(object, dl, toplevel=false) {

        if (toplevel) document.title = 'Entity ' + object.handle + ' - RDAP Lookup';

        if (object.handle) addProperty(dl, 'Handle:', object.handle);

        if (object.publicIds) {
          for (var i = 0 ; i < object.publicIds.length ; i++) addProperty(dl, object.publicIds[i].type + ':', object.publicIds[i].identifier);
        }

        if (object.roles) addProperty(dl, 'Roles:', createList(object.roles));

        if (object.vcardArray && object.vcardArray[1]) {
          var vdl = processVCardArray(object.vcardArray[1]);
          addProperty(dl, 'Contact Information:', vdl);
        }

        processCommonObjectProperties(object, dl);
      }

      // process an entity's vCard
      function processVCardArray(vcard) {
        var vdl = document.createElement('dl');

        for (var i = 0 ; i < vcard.length ; i++) {
          var node = vcard[i];

          var type = node[0];
          var value = node[3];

          if ('version' == type) {
            continue;

          } else if ('fn' == type) {
            type = 'Name';

          } else if ('n' == type) {
            continue;

          } else if ('org' == type) {
            type = 'Organization';

          } else if ('tel' == type) {
            type = 'Phone';

            if (node[1].type) for (var j = 0 ; j < node[1].type ; j++) if ('fax' == node[1].type[j]) {
              type = 'Fax';
              break;
            }

            var link = document.createElement('a');
            link.href = (0 == value.indexOf('tel:') ? '' : 'tel:') + value;
            link.appendChild(document.createTextNode(value));

            value = link;

          } else if ('adr' == type) {
            type = 'Address';

            if (node[1].label) {
              var div = document.createElement('div');
              strings = node[1].label.split("\n");
              for (var j = 0 ; j < strings.length ; j++) {
                div.appendChild(document.createTextNode(strings[j]));
                if (j < strings.length - 1) div.appendChild(document.createElement('br'));
              }

              value = div;

            } else if (value) {
              var div = document.createElement('div');

              for (var j = 0 ; j < value.length ; j++) {
                if (value[j] && value[j].length > 0) {
                  div.appendChild(document.createTextNode(value[j]));
                  div.appendChild(document.createElement('br'));
                }
              }

              value = div;
            }

          } else if ('email' == type) {
            type = 'Email';

            var link = document.createElement('a');
            link.href = 'mailto:' + value;
            link.appendChild(document.createTextNode(value));

            value = link;
          }

          if (value) addProperty(vdl, type + ':', value);
        }

        return vdl;
      }

      // process an AS number
      function processAutnum(object, dl, toplevel=false) {

        if (toplevel) document.title = 'AS Number ' + object.handle + ' - RDAP Lookup';

        if (object.name) addProperty(dl, 'Network Name:', object.name);
        if (object.type) addProperty(dl, 'Network Type:', object.type);

        processCommonObjectProperties(object, dl);
      }

      // process an IP or IP block
      function processIp(object, dl, toplevel=false) {

        if (toplevel) document.title = 'IP Network ' + object.handle + ' - RDAP Lookup';

        if (object.ipVersion) addProperty(dl, 'IP Version:', object.ipVersion);
        if (object.startAddress && object.endAddress) addProperty(dl, 'Address Range:', object.startAddress + ' - ' + object.endAddress);
        if (object.name) addProperty(dl, 'Network Name:', object.name);
        if (object.type) addProperty(dl, 'Network Type:', object.type);
        if (object.country) addProperty(dl, 'Country:', object.country);
        if (object.parentHandle) addProperty(dl, 'Parent Network:', object.parentHandle);

        processCommonObjectProperties(object, dl);
      }

      // given an object, return the "self" URL (if any) 
      function getSelfLink(object) {
        if (object.links) for (var i = 0 ; i < object.links.length ; i++) if ('self' == object.links[i].rel) return object.links[i].href;

        return null;
      }

      // create an RDAP link: a link pointing to an RDAP URL
      // that when clicked, causes an RDAP query to be made
      function createRDAPLink(url, title) {
        var link = document.createElement('a');

        link.href = 'javascript:void(0)';
        link.title = url;
        link.onclick = new Function("runQuery('" + url + "')");

        link.appendChild(document.createTextNode(title));

        return link;
      }

      // guess the type from the input value
      function guessType(object) {
        var patterns = [
          [ /^\d+$/, "autnum" ],
          [ /^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\/?\d*$/, "ip" ],
          [ /^[0-9a-f:]{2,}\/?\d*$/, "ip" ],
          [ /^https?:/, "url" ],
          [ /^{/, "json" ],
          [ /./, "domain" ],
        ];
        for (var i = 0 ; i < patterns.length ; i++) {
          if (patterns[i][0].test(object)) {
            setType(patterns[i][1]);
            break;
          }
        }
      }

      // set the type of the object to be queried
      function setType(type) {
       var select = document.getElementById('type');
       for (var i = 0 ; i < select.options.length ; i++) if (select.options.item(i).value == type) {
          select.selectedIndex = i;
          break;
        }
      }

      // check params of query string - called when page loads and when the back/forward buttons are used
      function checkParams() {
        var params = new URLSearchParams(window.location.search);

        if (params.has('type')) {
          setType(params.get('type'));

        } else if (params.has('object')) {
          guessType(params.get('object'));

        }

        if (params.has('object')) {
          document.getElementById('object').value = params.get('object');
          doQuery();
        }
      }
    </script>
  </head>
  <body>
    <nav class="navbar navbar-dark bg-dark shadow-sm">
      <span class="text-white font-weight-bold" style="font-size:larger">RDAP Lookup</span>
    </nav>

    <br/>

    <div class="container">

      <form onsubmit="doQuery();return false" class="form-inline">
        <div class="col" style="padding:0">
          <div class="input-group">

            <div class="input-group-prepend">
              <select class="custom-select" id="type" name="type" onchange="updatePlaceHolder(this.options[this.selectedIndex].value)">
                <option value="domain" selected>Domain</option>
                <option value="tld">TLD</option>
                <option value="ip">IP/CIDR</option>
                <option value="autnum">AS Number</option>
                <option value="entity">Entity</option>
                <option value="registrar">Registrar</option>
                <option value="url">URL</option>
                <option value="json">JSON</option>
              </select>
            </div>

            <input class="form-control" id="object" type="text" name="object" placeholder="example.com" onkeyup="guessType(this.value)"/>

            <div class="input-group-append">
              <input id="button" type="button" value="Submit" onclick="doQuery()" class="btn btn-primary"/>
            </div>

          </div>
        </div>
      </form>

      <br/>

      <div id="output-div"></div>

      <p>To see which TLDs support RDAP, <a href="https://deployment.rdap.org" target="_new">click here</a>.</p>

      <p><strong>Note:</strong></p>

      <ul>
        <li>This page uses the <a href="https://about.rdap.org/">RDAP.org</a> service, so your queries are sent to that server, but the RDAP responses themselves come directly from the registries.</li>
        <li>Top-level domain and ICANN-accredited registrar queries do not use the IANA bootstrap registries; instead these queries are sent to the RDAP.org RDAP servers.</li>
        <li>To submit feedback, <a href="mailto:rdap.org-feedback@cryptocracy.org">click here</a>. Please contact the registries if you have any issues with the contents of RDAP responses.</li>
        <li>The RDAP Web Client is Free Software; for the license, <a href="LICENSE">click here</a>. To fork a copy of the git repository, <a href="https://gitlab.centralnic.com/centralnic/rdap-web-client">click here</a>.</li>
      </ul>

    </div>

    <script>
      document.getElementById('object').focus();

      checkParams();

      window.onpopstate = checkParams;

    </script>
  </body>
</html>
